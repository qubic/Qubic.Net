namespace Qubic.Crypto.Tests;

public class QubicCryptTests
{
    private readonly IQubicCrypt _crypt = new QubicCrypt();

    [Fact]
    public void KangarooTwelve_ProducesCorrectOutput()
    {
        var input = new byte[] { 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09 };
        var expected = Convert.FromHexString("e5ef1dd415a069d5c1ee20a731c271d751ec9f301bfb8a51acf27828d231e305");

        var result = _crypt.KangarooTwelve(input, 32);

        Assert.Equal(expected, result);
    }

    [Fact]
    public void KangarooTwelve_WithFixedLength_Works()
    {
        var input = new byte[] { 0x01, 0x02, 0x03, 0x04, 0x05 };

        var fullHash = _crypt.KangarooTwelve(input, 32);
        var partialHash = _crypt.KangarooTwelve(input, 32, 3);

        // Should be different since partial only hashes first 3 bytes
        Assert.NotEqual(fullHash, partialHash);

        // Partial should match hashing just the first 3 bytes
        var expected = _crypt.KangarooTwelve(new byte[] { 0x01, 0x02, 0x03 }, 32);
        Assert.Equal(expected, partialHash);
    }

    [Fact]
    public void KangarooTwelve64To32_Works()
    {
        var input = new byte[64];
        for (int i = 0; i < 64; i++)
            input[i] = (byte)i;

        var result = _crypt.KangarooTwelve64To32(input);

        Assert.Equal(32, result.Length);
    }

    [Fact]
    public void GetPrivateKey_Returns32Bytes()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";

        var privateKey = _crypt.GetPrivateKey(seed);

        Assert.Equal(32, privateKey.Length);
    }

    [Fact]
    public void GetPublicKey_Returns32Bytes()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";

        var publicKey = _crypt.GetPublicKey(seed);

        Assert.Equal(32, publicKey.Length);
    }

    [Fact]
    public void GetIdentityFromPublicKey_Returns60Chars()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var publicKey = _crypt.GetPublicKey(seed);

        var identity = _crypt.GetIdentityFromPublicKey(publicKey);

        Assert.Equal(60, identity.Length);
        Assert.All(identity, c => Assert.True(c >= 'A' && c <= 'Z'));
    }

    [Fact]
    public void Identity_RoundTrip()
    {
        var seed = "jvhbyzjinlyutyuhsweuxiwootqoevjqwqmdhjeohrytxjxidpbcfyg";
        var publicKey = _crypt.GetPublicKey(seed);

        var identity = _crypt.GetIdentityFromPublicKey(publicKey);
        var recoveredPublicKey = _crypt.GetPublicKeyFromIdentity(identity);

        Assert.Equal(publicKey, recoveredPublicKey);
    }

    [Fact]
    public void GetSharedKey_ProducesConsistentResult()
    {
        var seed1 = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var seed2 = "zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyx";

        var privateKey1 = _crypt.GetPrivateKey(seed1);
        var publicKey1 = _crypt.GetPublicKey(seed1);
        var privateKey2 = _crypt.GetPrivateKey(seed2);
        var publicKey2 = _crypt.GetPublicKey(seed2);

        // ECDH: both parties should derive the same shared key
        var sharedKey1 = _crypt.GetSharedKey(privateKey1, publicKey2);
        var sharedKey2 = _crypt.GetSharedKey(privateKey2, publicKey1);

        Assert.Equal(sharedKey1, sharedKey2);
    }

    [Fact]
    public void GetSharedKey_WithSeed_Works()
    {
        var seed1 = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var seed2 = "zyxwvutsrqponmlkjihgfedcbazyxwvutsrqponmlkjihgfedcbazyx";

        var publicKey2 = _crypt.GetPublicKey(seed2);
        var privateKey1 = _crypt.GetPrivateKey(seed1);

        var sharedKeyFromSeed = _crypt.GetSharedKey(seed1, publicKey2);
        var sharedKeyFromPrivate = _crypt.GetSharedKey(privateKey1, publicKey2);

        Assert.Equal(sharedKeyFromSeed, sharedKeyFromPrivate);
    }

    [Fact]
    public void Sign_Returns64ByteSignature()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var message = new byte[] { 0x01, 0x02, 0x03, 0x04 };

        var signature = _crypt.Sign(seed, message);

        Assert.Equal(64, signature.Length);
    }

    [Fact]
    public void Sign_And_Verify_Works()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var publicKey = _crypt.GetPublicKey(seed);
        var message = new byte[] { 0x01, 0x02, 0x03, 0x04 };

        var signature = _crypt.Sign(seed, message);
        var isValid = _crypt.Verify(publicKey, message, signature);

        Assert.True(isValid);
    }

    [Fact]
    public void Verify_RejectsModifiedMessage()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var publicKey = _crypt.GetPublicKey(seed);
        var message = new byte[] { 0x01, 0x02, 0x03, 0x04 };

        var signature = _crypt.Sign(seed, message);
        message[0] ^= 0xFF; // Modify message

        var isValid = _crypt.Verify(publicKey, message, signature);

        Assert.False(isValid);
    }

    [Fact]
    public void GetHumanReadableBytes_KnownDigest_ReturnsExpectedString()
    {
        var digest = Convert.FromHexString("29A49B5FF4119B698E4F7508A3C5F38686BE4460C7C27D5E84063639A8153C5D");

        var result = _crypt.GetHumanReadableBytes(digest);

        Assert.Equal("ddcokqjpjphtbdahocnutrzglxxdcswdqzqkohcjtceotbgjrqhxkksctpee", result);
    }

    [Fact]
    public void GetHumanReadableBytes_IsLowercaseIdentity()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var publicKey = _crypt.GetPublicKey(seed);

        var identity = _crypt.GetIdentityFromPublicKey(publicKey);
        var humanReadable = _crypt.GetHumanReadableBytes(publicKey);

        Assert.Equal(identity.ToLowerInvariant(), humanReadable);
    }

    [Fact]
    public void HumanReadable_RoundTrip()
    {
        var seed = "jvhbyzjinlyutyuhsweuxiwootqoevjqwqmdhjeohrytxjxidpbcfyg";
        var publicKey = _crypt.GetPublicKey(seed);

        var humanReadable = _crypt.GetHumanReadableBytes(publicKey);
        var recovered = _crypt.GetPublicKeyFromIdentity(humanReadable.ToUpperInvariant());

        Assert.Equal(publicKey, recovered);
    }

    [Fact]
    public void Verify_QubicNetworkSignedPacket()
    {
        var identity = "UGQLSPXWWQORKDDJNOQVYRPYPWKDYLBCTOJCQTPRJFUXGTQXJAVACKSDDNMA";
        var publicKey = _crypt.GetPublicKeyFromIdentity(identity);
        var signedPacket = Convert.FromBase64String("SGFsbG9w3PrF3AvP1/epGGEbt79ZtwuDUP1UrxUKQSxw8Un31EKICNOIoqmuC9W/52M8Xg5islHGdAuPwOCS3OBjHwgA");
        var message = signedPacket.AsSpan(0, signedPacket.Length - 64).ToArray();
        var signature = signedPacket.AsSpan(signedPacket.Length - 64, 64).ToArray();

        var isValid = _crypt.Verify(publicKey, message, signature);

        Assert.True(isValid);
    }

    [Fact]
    public void Verify_LargeMessage_MultiBlockK12()
    {
        // Identity/address (60 chars)
        var identity = "AFZPUAIYVPNUYGJRQVLUKOPPVLHAZQTGLYAAUUNBXFTVTAMSBKQBLEIEPCVJ";

        // Message hex including signature (last 64 bytes are signature)
        var messageHex = "C60085E8F5247CC0150C63BE49BBD3DA975557E510827C1C27F8449CC1F809EA824F3DDF9F545E5C31086A2532D71619942A04ED3555454661FAACD16095E2F7483B84749814E39C83F11187DE31FFEFF70EABDF1FA3785F8368CFF4A2DA0D5BC4CF913F8F53DE99587A4608CD65E336E562C559B20C2F83D469AB5E9DCEE00D74C581A88E0C86DED18C21F91C379D0B4124796D79E1FDFC01ACA1AC7AC5476DBF73DE9D21867E899148D85191BC0BCA1367F3390F14B1218227D6A3D6FCCF578BB5C99BE3AD3FFA1F92D0CEE8612F49F428B6AD15E2DD3AE1FBE0B49C7D2F678BB9430E06E80962C700397F1CDC86EC2E3D933502400B02274339A29B67C4EAFF49FBE7C5EEC1F11C04E5552A99CF12DB517A079294FD5E357E1AE61497B79E951CEB9EB5E499DED0EB1CDF1B6286768B157F98350612AF7DEB1FF558BB90C5E8B55E3630C269C6C2DC0B89E98F8651044CF268DDA930AFB3CA399DBB6A25DD1D791EDC40B81096EDDBB137EBC2AC57D9505F9965E1335A55A8447CBF0AF3B4A17FF49B7550AA845AAD2FC313DA746B5262F5A462F2DBE63CA026E0DFF3F6BB14485C8CBBF02B05D5C32D06DBCD3E4E1B7FA50C11D24FFDC68AEAFFCBCA3F445158229624821B4FCEBC5570CDBE45825A0E10F4F7C4C3915FF45C60A5B8A4227D1608B9C026F57B0C6E9C46CCB90CEED05721000F4BD59420E2739C9E46DE2192761C31CD20654FEFAECB95A67D66B6CA53E341CD0F7A44D44160C7BD0636EAD411C6A2DAA5A1F89E3B38BFF8E3A030AA2949B62965624840EDF4B6D7B6B2C5A9194664C3D0047D3488B62A9DCF5A8D6C73D8E3DEEED2BA9F64692A1D1127966B57E68AFF50386EF95C7A1C17C37D211D2283F22EA2D527DCD788DA865B441A10D5B37861DD1A73458878F6A99EE4736A63DD73FA2DDC357285B130357AC66A6736BA57963240A6A51501CB64739AA62E7DDBE6A91C505165BB4DB0E40506153D644073F171EDA1E4F698CCA319F11B770ED930B6DC95CC63C4354EE334BB1713C5C4A768F78E8A3856F3EF1FDBBB35A1574DB7012411543F53C61FAEBBA676A809575724E62561562E97C0D8A32D821C7ED51DD14CC914487292B4FCAA9864487376FA51A25E1925A0D0CDA8EBE50D401AD18B737784A1B76B59CCB6786B272C65015626A8040C8781F421C7F7E04DC37D3DAFE6E44515284FFF8E4372F4417EEE4CC3F002B799438891719B15B2A4DF19C694A211A4668B5A76405130C5E6E603C55036B6EB1ACA3058990AAFF3D7593748FC9F550B2356A43B582BBD3B10C122DFFBE23F44EDD86478B73CD8701BC547F8A6B5CAC8B42A7117701325D294843114A0B623EAA29AE9F6792C6CE801A010CCA8B9CC15948DBF1F09964654C59FA9DF7F2C39E80CBE2AB3B4C96CBB950817859835DD6089668CF75907423AECC8DF450FB2EDAE4B5FBACC5A1269E4D5D210A454B8F2B5201F0CDE3D8BE64D6BB793F34535A2BFF93638E05F6F32CB5C7F20946D29654237FC24B346D4340A661BA5038BB03BA1D068B089D3BABBD104186E3E18B7CD999EA38772B52B99DF589C02C095409ABB23E13D01A64366AB85CD278C6A989F2F8549C81952BC992D9B2241898B6BF196E9BA9EEEAD77962AD6224208545602213A9C1D573537B0FA9BA989A561D5A2FC1B0A35E5F3BC5952E7AC316965CAC4950C01BF1839855E5766217A0D4DF3692F58D4A3B1ECCCD1F64C355B26D729893DF4143029641AA81A2145CDF1ADA69F6340E09ABE3ECCF0FDA7E14D7495B708F741959D0DBE679D0896C7DB0D8F677C15C2B8FB0A263045661DF74086E42CC70930DF45849324AEF509C06B1919899C040BFA15FC26F9A3B91CDE025459AE6DC07EE43888A453410BF2C2D153BFFBBAAE94FEA70A8C867755B9D2067467DDBE0B7B84F210B07734144FE8DF6F4A166BD0D9D12AACB5E72C0C118056342236D532000AD94E4A2E550CBEEDFE7850746703F41A8EEEA90395F88BAB4C8C3F28882FA8D94F91D75D254B0AACD228510E9DC98B86630FADC1D715369E63AA6A75D9757A4E4868295BE91085210176B43F3F27AC6BE1107A0425604E531D2E85F53D3EA8C504CE15FB9D47F50078C1854FA8B7FBBE75C9DE414704707F2A17F50F718F7B1A2FC2541207B535F915D6157ED738B0F20830656BCB6D766A272432CD379CD6A9135D41D312F501474D753D35693A75FDFA7DF5FFADC14E590A9329E2AC972789BD2ACF53F55EBEFD7468F78D187929015FC1D28C91F644B141F127EC9E6485FC3F63F8A552ED85293E716A5B7B69DE69B40A446CA7D6B51C0BD71031F12F072D0371CD4747836B32064404594133A2564558777290DBC28A0DAB989EFCB2A4A7DB8503AD9B2DC0558165E106E7374C35CD357C2F15482DAA5D239E11AB32821E74CE36A283CBF563F787C59996CB81A18BC23FADD0763A7D01DCB941EA7ECBE1865EDA04B47B03D8A70EF51161FD8B24504906DA073C55086D92B8E59B2ED95B117C63BDF4981B17BB51B6AD7F0CB52F76DAD169DCCED5FB1A96E5F29502CD8D20117F5BB544343D030D6FA2D10C02F7CC33FEC302BD77535D91E9C905785C6B0E7F03EF75472791748BBFE3A9BB5374C482AC1F7B33069128D39AC3C1D4CC8C02054262908B6194F64E25F09F7ACB5B6C730A7633C4794109343FC250F93359432246BAD1F4185E8BFC29013E60F1CB3C0D8F44B3186C4E39ED1D72623ABB8B58712D9D5FB359A2A43BFE7EF8BD2E02B9AE8919AF4876E060541A40C38DF676FCEE2EE8BF4B0B4FDD200076A86678E1A5568B4129D4CB52040D9E38C5F3D04A703EFB9CAE4F763AD863BB623C8E0ABEFFFD671446748F9861463DEA96DAB15C0E4DF475BBB77C74FEB89B6641E2D8A39966F5E8ACC60A121BE441FB86B607FE5F365C1DF33D8D3AAEB68511A48169049756E41F4FE2B66B032EB23BDD6D3DB49B3D1CAC3C290A3BC40398EED41981C071C6C8CDADD62947519E088C95ECEEA325938E848C955D584833FA1D05A90CA03A7671105C8948BD0753A7C1932C47571CACC15BC520E50B2FD42D5F606A751B6B78DB70FAA5735634CF376809F5BC29874F8350D7CD47A5DC98A1AC221D5939E7F12E2C2A6277B552EE82BB54B9441B6A7145A81B6C01F86AD1D856C42792F0F874DF7A0ABF8A070BFA5881A8B939459B0F29D78AD662558F5CAD2A9B47EC144B4633FA6D859F3A0024D32B46CF6FA02644617592B80C80C42BD97F32C06D76C9EF1F44373BB56A5E62D7FDFD39AC273858D01F3122D9D07FD232870B86C7E28C1A03480FBBB68238DE0EAB6C9BAA8756357BF2D9FE73C1C96B3AD9A5DE9DA948F5201DC01B33D77F21407707FC689EEC2F6A0657BC8C646044EEB7F13EBFB447449BE9D7BD772D5526123DC884525839E0F0C3A7CF7A26EB0CFFD5D53297BED1FC6D6D1CFA7F0177E3B63F266D3D02A5EC6CBDDC641E3A1762E1F19CD24E20A23B96E033E57DA22517B26515DB57D68F0E8802DF08DE1C144F10B93988004ED6641830EBA5FC544368A9E323068D931EB76699DCCA0EB6F43207269A750157F57DB0ABB60CE35B73BA3247267B4B65BA6B7B77CB942D71395BB6885BD7076E22E3D02A44B25C124F1E3E8288D13FF7A3E97A85615AC6877AF33AB6EE58DBC214A8608C9006AA4562B30E5BB1A3B11072AA9CE0E797F559852100532C89DD036855654BD644ED831558155B37CB233DA1B32A9C9A2C2D4A60756FC9234D210F17BABC646B13338C7DB62811053669AB32029EFD8C449BB1E05DB975F6CF9F7A6CED0D1E425956BE0E42414CB740E7C3CC0D17E6761EBF8B78B5FC5866B57C244EF757B26B52C1221B3B4AA612174D0C83D883CEDA579D53C74EE3036A72702F9FF9B92DAC0623886828AEE116C2CA28608AB174DA7F5BC95E53AE3D0CE7A769086FAD3DA526368F24435712504B4B0FA4941334C14966483E64C2040BD91040D23580D37F33B0996B2FC553DCC1741AF1DF1C34EC90CE6AB0492EDBA0D8A35A311C56A935686C520BB9939AB19E0F6EE16FF546E19B372BA69A95DF1E8C48BCA99800B87E88145A50E8105FF1F47A63CF8C380ECE485799D83B278B4A1AF85E66A7AE08E5620247438BF3C6B03D251912D81D14FB8084D678BD208CEBB76FE287C9FE4E108C8A8A78723F82390BD8B6407A61CB233D6C9B9117702134E733450B54BC5312D0B0114CE111DDB5DF8148610D0137D1518B8A3FDB23F93800868BF0CC85C2338932AC38F6CECD466C1DBB0E40EBB1DB3DB2048DC3EB8A17A8B854E50E93B092BC5CBE59BF3C13EE6C186C04424ADAACC7CC02C12DCFAE1FFA7755C0218F5477EFD9940209D91C7EE81AA25EA59EEBD50F0AB3D14523D986FA8F84F2A3AF215C14356745B2D7A1EFFC49C99F1FC8BC8212B1BEC641496AB0F7D9B39A874F97E646D54359168ECC5DCD502A5B315AA77BBC1138F7C046702CF8204B5C900CC4A7A5AA482B8DB1C4640FE4C632BA1AEF1AA2FE2C6525B87A38B8357D88F41367665406E86F83FB9675D342DAC3691CDC459CD198C95BC7BBA14BB0F6F19CEEC9EC25D4F301AE56FECC2AFE362AE34EC1E2406529312C3CE5CE1AB08C72928E42CFEA9E22364DBCFB12B23759D32F45349929096F5D9372CD4BE31AABBE2AD363816A497276660537BE2CFD00ACCDC5A8749B75B53A31373C3F7B8E9B64D652EF1B0702F53FED4919962325318F6D2EA4AD35D03E7808504B60EE2B232D05F19C6DB404F0218DE2C3026725F7C5EEA8B74E1338B3C132A55DD0BD2EFE15A97CF2B750317B4CC5A7EEE2B3A6D34413FF609790215FCDC32870A360824DE2C505629174168C1B6C0733955750FACB9C7A5351A6FE9F3697679C1C6873B0BBC24C25C59E7C0F32E1D2F89F8C968D98C591A3424C0684C8C419B59113CA37D5317A14110B51D527A924F6729912FB9CF085AD0845E8AADDE1EC593BAB5F76CD27464723832C01040FFEBC6E7B4C9890D918D3F25CF025480E8C8FEC7C2E6D8F38073E19A4A30D48957CD56A2AB93500EEB760C01291FDC31438835A9D045DDD74E870D197BCB315334186CFE20E95DEA97D2686F01FA075F91F4D0AEC99BFC35D16B73EB081AA3390193049B4134240FFE8043A0ECFA0B6B9681A5A5E58411D5675E49DA2A9EE756E109735B695AF8E2CFF312E14DDAFF2C44A7743CB72ECFBDA8E56A13FBF1902DAE32C2E0D3939D437758A48FA25180AC80BE7DFC411C0E061066049A7800F0C3C9CCBF98D6A67AE8717D4264D9845B9C111449597151A2CE7CEE3EA035C6850D4FDEA4774F6AD2C1D18E823B240E73143BA4CDD4AD762D905F7F0340E89D8056539BDFF7ECB204ECAA73F56F6CE96AA9A0EF2175CE00721925BFDFA35936054413169FE803B0C63CEF8BE7275720BA7F635FD316A3C2F22D79ACE53F573F518075675CC6A0716E66F4522CB9E6C2D186C6B1653FA7DE7EC77F61A92A81ED83783FD4E4D06EADC9AAFD989A1E3D9E1AC281EC135F681CEBBA1C8289996799F48A90987F1F0EB09EF08091C109F9F53A39263520905F41451C102F3E4C9A2434490CD766CEAAC5F03A5300F7B5A5E60C789124EDDA1AE76AE570BBC1F7437F8542CB9FB133594843BD8D25C10C47738B3A0F81CB14B1CFA267335D3EFB10CD325AC5C6C1F0978AF91BF5DB49676CC442B4FBE8C2AD4748604CDF5133B1BC17D30FB7F2F1EC21DDFF8FFB9F061F0AA457DBD4EE9473DA81617D38B3214381E8E6A3A93E49693DC6792639512C24B1F203D1FA9B835B6FADE65EC103797F15FE7142CE8F0BA32AA4833CEF55A1FB6F9E51B2CA50DBC0CBB5B70DEDC3EFC86C353195C7D6B5EA1555CB80D0871180B16BADDB05E816BEB2943B53AB9496CD6D98F25477ED39E6BFB1F6FC46F4F7C62ACC4AA8ADA1520A085184783F0790CBC555D04EF9BA0F5A630C2DC57610BC811BB385CCEA1B13D4B19E40761E27387A1556537649AD5698FCC47F41670561CD97ECA5DDABA833B792CACFBAC3912F201B4520F0AC7FCDB4F47E5FA80545633DE06C39E023617B49E83AC435CD19BFC20E86575187CBB60D85E68B92642FFE144AD22AC8217B0E0C4651C4B03A6F999A6189B00974C66C0F3A4A029AA345F2FC65AAC6D4DA2A9AA3CC2813827A2B88B8838C44664FA33006A47CEDAACE41A0C644F7A47DD1C66A37FD5D7C1A4356F32576A357A277EE0401323C7DABBE8023F4B5D75607812AFBAB8119782D6F29AE49DE7E60BDCC89659231A8D5A83E3F2687355756BBE03A1790A90E1A419DBBD12194C9023B6A138495C86B2E030AD32852A938B4346C515448E91B0DF1AA22D51AA380964922C989740A607D2690AB7382DC3408CFBE8FFB1962061E681256B7EE5F57E602CA630215AB9C7691ED69DD86023F634A6F082B1113BD303147710C88E8E4436F0AD85EBC6CA3924C416F070AEE7B714421859D31223DDD67213CFE33851F76951DAEE4D2D3EF7853466F0FF6CE11BEDCEE3ED06EAD82D4FEC9A4D7686DCF07ADFD78C85FCE05B19B391FBB60913D939346D1F8E701A3F26D0143374FBA9D65AC12E529F2119DB458CBEF39E5049ACC0197B66E356D0A28A142F32D342B3B94ACE37A18711E378003D497D49F3170F58024A3DF049EF41C2A116ED61086B89312E8E0E867CC58748826447C2F75950556AB8DC4A504318E583F8A5D90CD2053DC4A8ED3A6357FD6E0FEB81A1DF455A4A1C3A1DDD5AB85C4C543229C63D400A462E2622B061E681B80C6969777E443CB4505C2FD890C5B6909828A5C779CCDE622FCA8E287AC10B1D38CE244646A5BB9F49EA445FCCFB24FE74D2661629008C04733EA9DFDD0375AF76CDDAF1A67FFC63A196DADDF65886BA39A35FCCB507720091D277AE5C5D2ACC2767A333C48E64D773D60D23EF61473DFE60347D83ACF07425CF70A84F2004B4485E6719F5D16929A4BF54BCD63F557F9E5451642A95EB5E5DDBA86BCECC62CD19C956BB6C183B7C458E852B0DFEB93DE61249E8A9485D3914262D3AC382B39FF8B953B4F827A2B4F65AFE9B2D880B57153C9D03992C4231997EAA1A7918D45B0617D02FE62ED4883C8B3748D93E92518D04D9CB33B1D41E3CB046C3A9A06134B78FB77E928591223840B46E4F9223926A46944387D27A1E2BE2FE4E7B6A3B15591AD67739B68C4461F2D4AC1065D6160E287EE978ED473D36FF19C56F88EEA3751D52393D00AC4C88501316CC5220DDDE946B741929236AC2CDD51693C9FB3231F233DF78A31A882BD73DB38D6144D6B5F704C14CC2B30CB8CAE483CDA1D840C9899DE033985DBD318FF558A934CD2FC7CD02E28A444936801771FF44703BD19DABEFA35F61A02402612D409156D5D16C6B77EFC39C1F1CBC861A9BF61E1A98B1DF026A4FA1368D4DAC17B0B0B1F817DB4A2F854F93DF0EDA2E3189A51D83684503EA676DF08ADC3AB3374AAB9C6B8D43613A630DDE4B5DD48231099270BDC99A4407625BC0525BA586C3E2F97EB0F360AC80E98CB31349CD43060DECEC1B88FD563F2683F7B1FF8B66A9EE182D0A3AFC68108193F71F1DB0D5010B4AFF80AC4EA6F5B518C1132B9856790A38CF11ECE8368B2E7C87732A4F7ED517D7CE109C7703D65B418B072C84EAEE830D40318588B0AD73A4385D7064E7CB4E30A49D1A49A8709063D2153087C7F0F2119157BE505B6A181C08B97FED94574766CC6465DCBE452D564FE371176A52504BB2AB75475F933A9865072F5E6E67512A562375C158274C14D4417521AB3A64A4AD4AE012E745786CEDA738AAB773AF0E06FDC31749CD6A67289ACA9F8C112D7BE197306EE589740CD1E726872E64C83F53C58BF32929C32F4B72A205CD75CFB35AFF2DC1C18CBDED674E0B9046032C0A4D3B36695566C381E28230E7BD52CF19C7060EC5AE4712A200E9536A53EF8FC204E9D69DF45AA17364F78CE848B8949227B5FFF4DEAD74515A6B63DE4C7C23C0CC2D9D0083B526945B94D8B2802E225B19DD59E0B1D99558ED1A7B9F5178A6528C96EA894FE2922E8440FA003A4CC364A248205888B0BD424EA7453428221C1A73C0A2828705B9A99604D4EFE432D6FF3A5EB09DA05A012325417F8FF04EA977424EFA33FFB76865DBA18A922BC23A77A2E587394B639587CF9D00F13B781EF6634B784595ED257B0AEC7A789D654FF7F351D82B794EFBF1E5DC57E81373300A05B36A30D60C81E20774D9CB1A23B37D30D9D413EB9B75E91F26222548E9E0DD4D556F0AB27E93EE0A16FE3EC57EF4B29D7941716AC46A7940927DCD852DFA1C14EBAF77B059DD3C5D07624FD5318535175C0F58ACDAC503CF8252B2806F30760B790FEA3CE846DF96E573739022A7D77EEA7AF908520D96C964740E0526E15EEC30C24AAF65EA30C61453C05637A29B3B3CE9CE9352AA99243361E6BCC36289E5856F09AA9F258CBE593F2C1FAC271FD36DD5B249F24C311AA01F72BD9D150A36EC61841265FA1C48919892372E6D0C3C0BA4D5E2FB77034CBF470D40DB3D23E2F3D75E1C52CABF73E19CD64C84A436677C56DE2164F9F693840E1462B2A9150F30A18CEB49D93AA995DDDC01F51FE2C94AC1E8468E61D1F53747B879C8F0AF006A5A55AC134BE46F893CFEDFBDCE3F1E14C71508D1E7002B653C243390FB1601380D332719A89E5D8C53B3D4E093AB74FDD439D2C1BD5A6DF04B29EFBE6BC7AD2CB3E9AC9E027FC91049978501B70905C3C7EC1E48DD048021321929A31C248912E413A5980910B1E14B3E39831B0BAEC7D9B1BCEAD866E0C85403564B7BA02814135FCC2E212522ADA08CD6D720213F735CB137D4C6B4BA8C74893C8D7FB9A02C3116858829830053590E873FD1878C515D98B8BD691C90BC2ACFD89F81FBD5073153E8FE048D0F7F48A044B86FCF7B89414912D32D12169B35B35221B00C21466DC820BA7B4476FC3DC70817EBAAA638286C0907D0DBE34054DCC72AD9E81B6DBBAEBF9E759A10CA6D90713CEC8ABFF826E13DA81185E5F45E90927094B50BDCD9D91D44DD823B56CC0DD1A72E48779D44346197F4FE73C2119AA789CFA806C4789185B397D3260564FABC32732491B7D19261D30E8BBCB3515296EA60E7FF2A8DD792EA67502E2CA8EA41503A38C5E8C71904BA22AF851F62F0CF314241083E71C996E8F2456AE422DEB13DDC39452A54A5814CCDDC1C9C3599C5E731A73ECF36C087AB7ACEC6DAF50D8CB0BAFACC161A9F28C25E779AA109B4E731D744A06601BD507E08B76660E3CE7E6BA46FE2CB160C20670EE911292B3D984DD8DDA150CC2EC6A5FDB37FCE624688EB3A8A4093A13BCAF3E2E701C26B16B8CD1439B3172AF6576C51510DF13FF92A7A685A793A18B60160DE52D78F16BF46F51972137FAFB15619D0A2BD146B7610AB234AA5B2DECBF260AB8E89810423AFFBB357F6BB765C65B1D51DD427BFB18823EA34A5D3949C8E5A7E8882D2273690F7AC2CA550EFCBE3BA489843F5D016690062BB835AAB0BEA2FFA3D2D9743F1D6D484EB5AD89EEC85AE6BA4B149989E5E319AF289DE683C6EA7E5EF7BBD5C3C5C03931AE566272B6A01AEA83DA104A138A7443B4B7ABE153439EAA742E36C055A4EF8412C3EAFFF2A5C4ECD64F0B560F8BB733038CE5FCE58726F00A90E4232698FE6EA736C5D2458B44F8A893D9ECA105FB65B40E2B232B24FFF80BBEF33C6F3D60EDA6FAE2C51EEA02CA5ECCD0D5DC6B93C90E126A8E303520F29FEAD515F09885C00285A162A4A91197FADFF7317C1012D0710C39EBB169A6443A7B47DDD65919312A861DB94D4342311B415948732D885F43F7DF120D639EA2286880B8DD6FE157542DFEE4A2EFE935531523C7B3EBCB49C0D069F503E52E012208B5761B4C7A9096FC47B07837F11EEDD4D81C2BAF3B29B28F99CC8A045114FD1CE2E49C4DA3F4F48B6BFD8DF6F943E454D43B726109002B5C0AD46D14C9E9D37E666CAB9C7CFE1F8676161BD0E4902D480A7D094537C14A82FB45425E578AB2A5177CDB7033B79F521B71E1C17A3DF008D2812DE7C425ECA12783C7715EE9547DD7493F6335E44EEF9297AC6EB7742217F8010622E9D7EC6467E9F2820854BA5C66A2B5B35F571EDF2EF225FC426F3F5979DC81D873A3FE11BF763866A358878183DDA9DAFCB2ED062838AFDA3F6EC71BB2F5ABC936A5DD497BAC2F903D45C8AE3429335833430E3585CA64D2D8AE1D3FB759AD2160AA4E1AD3F3B1DE938A26EA355812E23D7B2641A849F5BCEEE6779B129A2DDCECE7134180949BC053B6F4E2719D10AD44DC48DBB3D700A475018AA772F1473E67082CE95AFA510F2BDCB117F5D9E6AC69AE9822BA2196393F76D8995EA5AE971603845171A662FF86A918F4F3C7FEFFF4B7F9FB936802712678EAE882D326EB64C16B55740E37D7C332E224E0BF7E3254FDF3BA0910B489D2EE8D2880F3AB6A8A515022CBD4D2DC1A27AB54710B08111C28D845B2E9EDB380281C8B0C1DC97B59D7F4C3B9019AE773E62A6B3161717A96C2CAE6FADCA0F6CAF3849C4071FBB02BA881E92F70F4250008DF92B322E978AF4ACA114B073149F24C7DEEA93FC1B17C116B6A1B416532538D8C8BF28CC21F9CA26EE472D615748DD3452FB4FB43D85DF69E4E9C92938A214C5C20634D90768C0E98A94575FEB9AE53D3C60F8DF9CD0BE7E3D14CB54B12F6B43A443147841E248EEC19889FB5F69A0A1E219757D4661F3D0A662C7F668F61A8114427A5262FA6B2E2A83EEBD814E27CDE9EDCB83FA10DE4B14B7AFD4188C72AEA57C26AD2FDFF35E382DC198C3EEC752F170D342790AF00468648C6BD04C294D2C1476991A27BBEBCD042C20DB19EB9169703E1B750D0776A2D25579F546F6DAE18263A6818B95906FA2417D0F1E553010D315061CB51B009FF94D5E2B397D83F3E61A2DE3CF2A66BF7241F84D0114511245A97988A4F4D8F1D35752D1BCD74B699B152653663FEADE3FCEEA840089CEF2736455F8F11A2201C1AE4F36936B83BEEA2C59E9E119E6BC4432FC426E7BF71E93E0E34FA18C7AAF9F5F71805697EDAB775B85C308A3191AA2A02284FB6916C1E63E8D394CCB1B10BB077455BFA41CAD5D1D14E05A2463549DA3266C0EFC58193E31904507C54C79D52020479AFBD1F50B19DC5E3BAE01FD8EF1BEA35A4584A5D6C7A89EAC53F624E394D7DEBEA9BBC3B71A64B522FABCF0D9E525571E8C9A2F752C2146CB115D5C9289A15FAED58F42B84B537676C71E0FD82B0B625AD4EDB0F6FAB8721E0422C1CAA7B7437B19BCFFFA4144FF4D56DF9675629AD2B5FF762FDB704D34C04BAA4C5B366005D97F4ECC11697DA00DEDD5E72674DE57DDC593EA5EE2962822BA311E5822E3A72E12A7EEF446D2775137EBADF3D76F0921908D873328EC4D7447BD81050967C9AB4A6D0E3D6F1C08F7B9028517E1289B1A4E7AA59C38015213172CD64999624CE76FDDB25D3ED139CF266D7042A19AD033236BD60080C83634426BC99DAA83D16EF2BAF7CA3116C196559EA3CB888CE63CDFE910A271F8AEAA96BC1D24659278A98D6A74FE6960FB036B8254A7376BD1A8E3CC9183D4A7F3D151C858FBDC9A5D5D5E378B426CCB981D1111479D555C2411666FFA2E734506B5CEBDD4EA9D51DEA30CDBFDB03C8DD97FF3909B6B35F0415CE6974D5B433E7755F528EBC0B996571308811B7916AABDEE2C33A0F2C15384A22FF3DD076A20517BAB2B7F9D02BECA661AB6F6A96A47127C77221C0B3ED92B158D60932B877A8445247DD22808C90AC13D07D7D100342BD1370DD2E77FFFF8D844F1E97AEC9502246303D441FE7C4729AFDCEA0235B2C25448D6BF92CE6976D7301916CA3C8478349519BAE9C439D20FD82EA4344656BE4C766719A14B7046B96A4DF9C95909564158A3A6BBCA9D7CCEB704330F4B1F88A583A2431D7A4B3BE1967C2F6915F88FF844BE4EB4512F310D5F3EF09B229EEBEDB81B9C8BA8734F00AD1832547856B2576D9FC8A8CB0231F527584C2B62C8380C0F716A5EEA1904DBF9CD26A341AF89A8774DAECB3E9242E89D59BF32572EE1EEAC94C0F6EEE72A5B9C542DB70E7511CFA50B7BF42CA4BC478B6A6A5B29A7851F747DA976A7C6FDF57CCF81753E28A3845DDA13B7DAB890EC7C47E73120601AC12A0D7FCC51B586FAB61A5CA8194047FF8DC53ECA45BF9AF6F3403CBA11FB8E987DE9F2ABEA511618D1377A32B04BA771AA8B499D6B769A5F996C94E879AF0FF6E9D0265D8F2CD3C92C5E9B1F92F2A1F46EF910E60338D0DD8EA538EC107B5CF9DD120DD7FFBE0672F37F6F3CB8BBF501B8FF966ED56B284610CDEACB5E9A4EE281CD7D67B7E2B0E263655864C1E9636D78FE841D7D05722E953B3ED322A566EB4777063B2E4F9A517D393B9BD8500F0B96596B553393157531A19CC04681C4CE85668D791D48D9EAF45267259A45D4E54017E04E3342048B66948F3231566B030F6536141403D8E8D42EA3C3F2CFDB6648D46D4D7401CAB34C51183E001040BAE65B9B9C650985C2C3D18F49D034AA30145A152F7096B12641E4D9AA3379F3D239AFCC73A2B332BBCBB95B26F47EDF7603963DE6C8F42CA585B4793D2DE0767D353412E2743DEB13353FCA0FDB1534D54D5FDC503D0C35C1CB75F42947E82CCCB04849E6D464F537B263461173D9366010D58FABB3C16664D7A7D22A5B5B64D8E78A6A2006B17F0F564BFED36C2EF4AE4AC24560BEC3E273669768A76344746C54D0C71AC1CBBAF704C265B0B318E6A015A885A41AAA529017A500B521306278D5A58FCF971CAD6D491F7F4A912DE536693BE50A998B33ACCC42E724313866C8491671875B063BE68E344057BC43E789A0A9C014B7201FD7F804A218605A79FE7F7ADB6F8CEB9550439D6673C2CB50EA9F8E7013C71867448A83621458A723B5A621C896ACD012A3CDBEF3F19E27402616C685F579E233E64056AD5553FD475541439E68FF6587DA0F9EE05E8B7793906433F9859927E3541AE93F886517F450ACB137665264A8D522C0B0BF0765247163257C45B11B11FC6B52499E67BF4D6EE3C3293E819358D019F2C8C2BD0659B9C369E4558D470C8B671933D55748CEB649007979DE2FDBE3897704960012FFFB30E572364ECA6F1989EDC1191A790F1DD457CE516C0B14E0531AD5D9F9EC86F563E073F555A20AC04FEE66E569245112C997CC68849990EB8B966346D5D6767AA1DDAF758A01843C7EF949F97874F2A28F5ECCE0870FF95B66FE346C1F0DBB1400B64C323727BFC9673B11B900E832D5BF6147C179F48703BDFD17FAC49D36EF62A4D2DC3ED4E097493D33C70BC54FA7B49BD05C8B3CB65B769EA4D5BD2FB04AB00D9C2166E1E9D9DB1DB2D52441FA9864986465FFE1400F67223192F86E44F77E015EF26403D0CD52BDDA3B77FFC01AE240AF227A60EE6790F7057072A942875FAADB98E883FB4048A2D8014BCFDFF31DF3AA89CA516DD8F623CD6BAFA67FB1AE926E32C27E0965035D7B5D47450629BB9C8CFD68BA903B84584C1404011F05621A3B65A3D810F14CCEA7BF0A3CED2793FAF4A9D054692108D2AB280C8BB99FB9DD20B8CF3EB4C0060B3C324275D3D537CE2D577A68B221BB86B537D3C672A406FE7CDA0471EE196DB8C3085B417ACB5EE6E1A5F526B16A1D362B23182BEC24C13CBC890F787FCD4F00B2516F4B3F738E1691ED3A81359589DA9BF3DBA60A4976270EFF05F740457AF59B7C5751E3CA0F5E614F49159A8732B25EC800BB485B42A6BBB14AE5FB87C41AF956413427355088B297728CA93B3C6578775F93FB30071F087CAC25D7330E47ED8957D1CD4A52E905DD01AB96F91702FF7EE227A06A869EACFC125429117411F9655CD1A2360A23A851894AF5234B1CA60D4AD31AD34A736B084B37D3C80BD3C19F3E9A5F79D49281F48622BF5E73EBD0903D57E81F2DC2377461E3656691016CEB08CAE50E2966F212ED9B921A7C92D233DF7EDA046A901A505F8BA9813860661276EC102042AA954781CC8D7F599A13465A83AE20324E973E958E2FC479A424E44192DBAFF197075E6F70ABC4A1D03E5D279B971E3CF5CF03F8B3B136FD3510C729173692958611C721506C268F53251056DC516489E9C1CB34F2E594DE66D9F86AF05D494CAE5B5749B30C26236A844BD6E3ADA739E140BF0CAF5E1D963F0254403F5B58BD0E7784C6383521DA39765DD64FABA83D453ABB74B51D7EA901473468263C17CC046996C11E56A4D6363076EBE0D6E2226B89B96FBC32D6481A81AD0D1FD2346AD2EE9761044E0491A42736DDEB6F8FC4EED16560A4164DBB2C8EEC093A09A837732B8EC97E4488D1D32D8E1B27E99AFE29F05712A50B9B73E06C0811EEF6CAA037F4FE29B48097EB91EDE9079093F3E2AD5559032F357A93B5444A000448BC730F0E70AAF7B4B4C591AEFC23E2F5146F2035E59DBE04E64EC2190663C3AD070B8E0BB04B534B031730E625CFFCDD2FB2316B20CAF3153EF5F2932321DB20FAA15DAF679A63B37F1B8B06471CC23F5A02250FD9353521FA127AAD1B5B44ECE52CB5BFA8B497D96BE6AFFD9778B97AEDAD9F40ADC9A9E27814E8378308566026B4EBBF5BF9591C6FF68BEF17690D4023582CE2757CDE20AB55E6F65F530C9070186D26B4659E811E21DB516C66C19DB911E9F5000C26E36ECE6B8BF178CA3CD184D9DCF000874D2E9B4A42B632C8CEC0B2422867967C4A37842FEC802ADB65096C597C1460B11817345ECCAAD20A1AA8DC4DD23FB5EEA5310D3436DE0F7448AC4DF41DDAC5AB33BFDF07D4EE9AA7993EF2E5B9A27A15ECBA1B35BE880B299C5908A7F7BD688EAAB94AE12F6DC36EA49338758F1DE36026EE440FAAD82A43FB3B91A3B493A82C4BE5A4C1D5D1CFC218FC4A76E01A882552A9B1FBF05133E9B60C9E8F8A50190CBC8FE7CF1EBD21233960F38C04111D70E0479166AF713B820DDF2EF2013A890D11A8BA1120CFB77741AA30F7347C3C296CA0163FFDF81EA519A9981ED7912394FCEE36FFA31D446247978500C2D2D64E4CA9A11A377E5A7067566054E444E31CC71FAD2EA397056426567CE0B87D844BB05690C6DDCB2136D61E505FC556C2F2E97077C928D0045244253D757093A0D4C5EB035066332E1CE8B4A27B1C9951A9D3D74BBE7D447BBC008EBE00AE17C550A8657421EBEE7AE97CC4EB6C8A4D3BA24C0341F5CD0625B41B17D8C140D7E44EBB40CC9ADCF278DC652032F5525C52DF3A6F4DCEFA50C45C171BAFA5251545151F0539A1800B50211F7FDF517F539AB9701EE87B7246F6EA3E28ABB60E2A1ACFBC8CE4930E307DB8C2A8B71BA6C8166D37C5A9ACF85106FAEDDAD2F922985339C06556C1B01A118DA133018D2F0685460885BE173E647A7D527CFE3FCBC30957A87C094BDE5F3F635D0584AC2C132CD00718A10912DC011A814C1DB2A1FA63FCFFA4A251EE18347162AA2558CB79D2E504E7B1C7946251F94A51C7B97F69700D64B8B6835A8B1AA32AF4B88D11246CF1D583BFD8F13C8F70EC1BEAD0C02BB89C8A5864EF4A3F1FC26DE2912E6484699AC34272762BA40A782E8CB7E79D4F12B81EA55C1AD7BC33D57E4DB50D09CC13F2231BED320B0367D15CC96F602AD0AEB284EF5432939232E1650322EA869B03C999F7A7087C7AE44AAFFBA15D088CC653C1C78BC972D91E33BE348D9CC400EE0126641B8D4D83C335F0745407CF1C711024C2E5FE24DA6E2333BD87DCBEA99B75E1DC01F28ABEF394CB14DA7D53F2CEFEE041EA4910D86FF0B9831BF53851AE3632F7C62B196847C646E8B72618FA7685843A7CD710111B3995C8B6019E0793EA0BEC3712BEA443DA9C6D572B524C119E95911E93C3CE1E24429B82EAA581E9E4E6FE0E0B9066EDB0A7C0572A1508080E40D2F956B93F448D3DD4917992A05598AE2AC33D537B0089F485F91BFAA4D1CD0BFC2D8412EB308219B707FD004B5CF7337539029165D9BECDAAF54F5A022C0134B3E581DE42702FEE77D089A364A44693F9E0DC1CE6B2E0456A1CBD0B5CE8661F608EB8BF99214C100EEDCD5F14F49B6C73C942A149B335CC6171B40D5C424CAD396CB53EFF7801FDCC720644A9B6769EEEB626DE8A89F3A4DAE3D7C0E3D7EEBFA32C00EC30117197A4B2ADF5A64C066A9F978691C6CF0D897EF5D7009265E1458D2ADFCF923B90BDA82F01FF84853998F935738C2638A90C1B83FC2D05392CD10D44A36BF135C0FB154EBF85AE8FFC0C37F451C1E2EC045DF7CFBA8029E3E7BBBEF53FE3B72D7A7015EEE6338A75810EE7512E2B27E1CE426B08357897429A06C2B62E91F02DCA5316DBA17DC21F08EB6542CB34251599F30FBAFF1A30F5CA512C7186C175131A1B5A3527577973F92CBFCF8945BD812FE7BCDB48329D6C4590A6CAEFB27C4F3CC9E51B7C299C185376AB8AA7AD7439FA37DADC76A979D849874B6A706D7F45DB402C57283D9290D33900F4641D1E5B61E2BC2AC414D01E279830EE87F8B00F8FD5B2B56E4BB65C380AFFE0D0A69F7611E4E6268D1B836D1BEE745324C8056EB1932D8845E238D2F270BFFD88863F4F4908AB861AB39F075371EA026EC5FB664E5152B5FC42F2737A10D51832A152E8D1A02EDA905A6ABA47E40A37EE0E385D641A6AD6A15A2C9FAFC5DAD6BBB617A10C48156606D98EC1B79C8B292D7D024107D82E0B33B28F0E45F20AF37751B51E51BD95F445056E1A6F13B149E55A6676DC0E3935B8BC03B42D7385D61130A836A0302888F3DCB7FF7CA38970BB7D5F7F2E979669662F5F0E0031B4720C8978186D9CBB5B6024D2493ACBCEF889F4AB22EE17BE3314C25A30DDD54183BF04282341245E08873A192C24050E98E6D82F6B08ABC468C0B2E1EBD4CC46376EAE0F46B9780DDD3CD50302F9D8A12B484E090C9AF99F1F838BACCFF62F8687405ABC4215029D29F134E11C3D44C244394A746378A99C0DDF46FD6D2311E94271F8AF55E91031C5CA6385C234ADDF2170AA18223D42D088DB2C981F232345C65199604139175AB538BBA6441764AEAB12E1C82A0C38CA14118681CA02BCFB6738CF5B8D323672BC54AC90C11C7668196CAFCB5F469336BDEA50BA046705E966C935A23281706B7EEBDF26482230469A2ED4E47842B1D594A082A59D11FEDF1B2766D8FE4E119C4C65D957587D7DD055031C227F8A1CD19813B2C34F8EC43D48D295A736EAFDEFB7369936590640FD5F43FE7718281A4CC1E66D38F123F3F94EBCE7D16704D784D5519846F75C540189D178E057C06BBA1FC520E6D74BB8BFD9579B1E5EB9135434A900447B8E457819A1D85531774E4F7A0E728EEF04B965EE32373190D211400084F011C624F8E8601BAE216DC8E7903C6E8AE54935ACDF2B198D103AA690F004E1363C30457CC0B951F95043A6087309CE8956EAAD3AC856DE31754A807D7CD489997415AB901A9A9D36427F4B3558EFF580A6A820334E7B0E2B804C7A48803496672B44EB9297F38F65AC5AE07CE44559D4AAA403231F4DD34DDDB98CB71E2D3274C7D2DEB772998115B1314B32F128C1C274E6A0CA401F76EF6BA2BD22A882F1033E87CAB879989FDBF26D8571507F742112C23D7F3697F382C10C0F715A1EEE2FCE4D1DF23714335F3F0CE671EDA7B2F5274E036F8351B47EE6CEA4A49246F71EA9636345E25ACC963C79093BE89E618045D5919446723FBAD8B6B3BA3F823B5BCC9B590DD183A5F86863F686289041A5EAF51C8B13CC11D7B7C0CCB43EDCB2B9AB8100BE3D1A68535B430F76FC32CC963DFE114517432F533F1DDD752FE3300CBC6EF844FDF94C8D0E72C5466B98CF253B0F809138B2F83E0949ECB41740D8D1FD32CCB9E826BE3B592AEA22683B89F8E0140D9CF3BF4945D68E9CE40BBC16DE27D92E44DC01E0E37275722F519B07FE25AB8A0B93630A828B958ED28879C1798EEC858A08C77864A951E3CA97E33B65898308A7C759705D8EF5883E17FADBDDFD3E733787D9AB24223ABAD4189B14EC6AB1C6D589C3841E8AC2AD97A6999E2C4B21801782234CDDEB4B0E2F42A2AA26E990E5A4A97E4D23BC5DFBE362CCE7DAC7C8D415518CE1CC2C17701FF227C0161B046E31BB812EC0A241BF8356AA5C68B553A6410A2CD1A9DA70C05A36975618EEA6C5528A3F4E2ED9E613E63264EE5581ECB017B5B9A9C32B67D9DE3D8F9F2D6C6CAD4E2135F8F7D8670DEAEE1B08792BD67DDA8D7D28CD39706742E8A7CE54362F28E36B0398D8363D51331008771CC73178399A5ACF4A2D037BF2A83668AE8E8583F7B4C20324ECCE6FFAF6D4AB6DC121D30B5C5224F4714521A502A6521090783B203D625A2CEC90E9490CD17F69614E564BE31E70C8287464E8E8CF4D8453CA9003DC7AB6BF1CF16ED97883F9DC9767CDFC50F99A893C61A5B9DC2DC9B5C116B4D94120BDEC08374A5CE5C1741EAF47B0A5F3597BE9FF17E03DFCCFC4BF96B873FAEA8A10E77E2B923492C0B7E5CF49158C701A8AFD28619D82FAFACE213349DD73CCE5266A6CB05C0374E6DD468BF9AE7F8A47D3F4FF0F51E5A1EA3B6522C8798ECC9DCBA6534514CC64F01177A0DFBF98E06E1212BE350EEB2E9CACE90C04A894CD139B0336D023563205CC200712EA5A47120749450C9A743A0D1FFD2D2CF6FB5AAEC18EC2E2B49408D5A9796FEABCA07E4F47DC62606A778D67AD8C22AF6EA33F70A11F5347E848A0C39567F42E161A7DD88EE244651003779BFB92319E1FB780639F594E5E2910EBFFD71524E07F689CAC025E543503F31A78DAC09C00E1B24A99F3AD6324F4F17D6CADB03EC452BA259900DBE464683526F2F91803024E0FC57A9710B2F525ECA9D766BFC85D4179BB9A74F39C0641BFC709232D58F7658AAAB62759890706BD6418B1255C0604C3B3F43E3CA837AF33D60C5DBE2A79A2E9FBD0CB42AFA8A2D746B6D9C1DE6E175709E8789CAE494BF18F7AEB5F5405BB5A98ABCE2FFE5465B06D2F46CECD5C380AA0A74CB6DA2F9F44FCD35905426E6362C6AE1BDF966AB29F15D3AEA89D1C9078B4DEA2D0FA1C3FD34C62C7A50BE1ADAED622931FDD7995550FF3B77BFB5B577EF4C6DCA84E4B16B8077C0E8D94AFEB1C2A5306A40377BCD6D9DB88964BD4585CD085EC9BE1760BE756ABBC576B6EF9B32786AECC8417DDB20FAAF287E2B81EB7054074B7730AC2C262289F22FCD46B41FC9B22B4AF10394B437B662DA094DEDBD1862049254ACE334C51EE9A5D71F625690D4C1067DB94A6628718C4264FE0C94F69B15BA95AA9C5046DFD1D0BB8AD404AB15D50910E026EA2408D0F856CFB39C18A84EE6A57EB70110D90A6842AFD0C38EB1A9AE9606329E31BFD9317255F026AB7C87F4C4621183E96A3E2EA41E04451AF2CBB63A99C221F7FF8636ABE5DAC5E89D78CFB40DDA6F59E1D126420B7AFCB14625300D4DF932AF7E234AD47B0C21621D57ABA056363CEFFFF51418EEC2911BB83A0E237E92D6880EC979B8A4C9EEC63C61EA2176D9D39EDB5CA3B6223A84E853F2FA7936FDF1138CC63CCCCAAEA6A028A04583F9358FF9F79F9D851D6E88F24FC6C149483E16FA06540CEAA6A876D32C9067B306C9ED783F9F9B9F94137D3FBD2A21B1E33DA4A2DF0A82648B3BBB7EB0DADD3489BE8B1DA8A221D9538D290FA6C580B5FB20B48234138DD4F45C5CF34155B4D4D851EE7EF82E315C3C53C3021B2BE5940A634A867D2F9C46F34D74125716D59044C015954DA995A7C9B128666B5D3A31264F82C5D8E78397B8D99D67612058B7CF4CD6AD47C65D9C04BC10E304EB2D575FC1DA68E46AE694278219CC0FC79A11E36BB76432D295EAA24DD83AF163FCB11BCE6E6884ED83ACE2A276AC019E4E92F724D530DD9B2CD99D809FD64A1E5C6F8F8D3034C66D4C0E606735457EDA7C4182D548B1B8FE02BBA2D82C1270AA17FD2A6A535F519D57D3D0B4F8C803F0B545AA7CC3A5FF76940D052CB2D3C27F455434950B4E29923AD326FA5B7B9E96A9E3EF0A2D426969CB0E16C55C5FB88C676A79792E7F4EB2F6D3CED0849099EFABF717894EEE6D130BA8B30486327DD89FC2F9319098E9FBA7EF6E036B6671702E5554E1B7ED4E74D31B04084B7443159575521F3115E5D3B6ED2A6A53FDE93DF5F7B1CA24B0DCD7E33461EFB80232EC21816E95F93AD35FAE7750FC64A5305912D33A8C6039312674F4019C11D01714915415E9D8DCDE8C242CE83637E5392AAEC5C9D6379E28D1381190E0ACDB38E3644093D8EC1FC730F97ED988691BC32D64F339F83EA1E4E6CE3FDCA1744BA45CE51B9FAEA44BA509C302CA5C178AC69E1B5305A34D950EDD71FC17F0A074F2670EA0A53352B3044A6D458B1415B7906AD3415DB363EF96EDF59D2F5327621D2070EC5AB7CEC42B515425F218CB0DA1E71945D8542DE4049029BE3E34B9356E99955EF22AA5B2E37133FD1D91444E990AB0478A44E6EBD119B93FC08C5C7F8C06A819149EFCB5F24E809F8D4072E5D067738764667A8C8E37699438AD992398EE38983F4E23D4C0EDD11B0A98C0721C87A3E0832CBD0169B95F0F03B8D0DC09C295E6F089CB83E02B651079ED27286DBFFAB14083E89E76EB9E3F3E302617CAC6D5A191B68203A38361AA4D03177281EEC254F49119BF0406BEED7BB8189884CDB417B797CF6A45F509411A365E9C0D89F3C0FC900944A8EB6C2FBE4D447C5F9B573E2C17A7385829147CF34682F3FD1027E26A71FB4036712794BE2A22EC6903000C3D64B7E4C44681216411F6D205BA8F46B44649F593753997972E79527017D9D2F383D9D248207DFA0D524FD7DFB68D472F9BD19E7BDD2098CC84AB7FBE5E6AEE4D4A19EF66DFE2AC6DBF14F39964F507A99159300EE21C770AD760A5382A69DABED16D55AE07F54E8910F8FF272E3127CA39C3FB348E29B123ABB50CAC2E101DBE1D9BAB6155DF50C35AE155AB3DE75438033AF4C293227B8B72FE8D16D825AD7FBCCA0F40A1BEAB1A9C0C4605F7AFE262ED11C496B6BDFBCB2EFC4AACD979F5C446F4826301AEE86D87483A56666A84745C713CEDE55733F32EF31D282EC9E913455BE48DCA1A76AD16134AAD3DDD06525CF9793FE4522157FCC1879CA0A5EE6E1F7E345AF43F579B61AD9119C8B84031D37C92E053C0C4C69EC600DD55FB2472BF5AA579414D1B23FA5B0524AF3BD2E813D52A743CC6EDB35F2956AA415AAD760C45FD88EFB5E2969F28AF1E7380618D10EBD1F79565EB968AE6824AAA099E82D6C5DBB8724C47F90E0B84E2B945F599CD9B297DA95B248270A3CF18B19DFA51DD162CC01B6C4B4A8787FB082AE610FEE949830697F4471D4768D1AC07F15BC5D2452A229F98CF67DDEFCE41C82CA46C7F043DF21EDBFB2EA37B9C36A457323C7B6EC907AAADED45E55EE972448241FE8C8CEB087D37CD847CA408315329C171AF89B092420E6881254D5268CCBA21357E34A2D5791ABE6676EBDB8F5F413B27EFC52E6C0B4B74E148183D7D9F22131E927AC6FA0F70DF4AE8B139CE7EEA1D09DE0FF38506DDB2B479C6CB446F3EB23DA9B107B3F93F0D5734A000A1C0FD9914A41F4553BD35394ED5339B4B1B4E33CF5B0454D42FE1ADF485FC1447325FF3D0717262DB7C3A3C532C8A85992BC1D6F3B6ABFBB7EDF8D01F0CEEAC0665D999AEDFD4EBB7C1F8CF75554954093DB1D5736DC84BA40F8EFFF536F3243B2562AE353F97E563028DFEE2E46065257DCEC617D602BFDEC8BA7ED3A0838622947035B581CFA5A4CE1A73A6BFAE3CF049CC2269954CFF7EEE6E6A699CC147713BB3729D8D79A449B65C51FC48B651BB9C1E451E2D300B92EE31029926432AB9AFC3A93A725D5667ED0A03B08DF22CE6EC8C65F94FFA04A3206581C5023D0DB579ECD6104E78026BE205D5E4C722877FE76CA3ABF7C960667E604C07B147CDBF308A4E4D4E16FD899052A41FA17E6092140EB4DD3AF0A2694145974E3DB4D56958C119639CA327E796BAB74005BBF13DFF8F72777CABEB99768045D032922982CB9B10597BA3C15A95E1F4742FE9CF6005E5B7DB99A2CFAFE5A6846615290278E5C7E9130F013962A4D2666CA0EF6CE760BEA3A780B33625F01F0AA6A4382A7CC73642D75705A02903DFEBE404010E54FEE365742D68BE6AF0C4DEB8D2582454CE1227E6EEB6FFC59D1454AD7E906723466E919D09B876F50830CA13236687A372D8687E64A62C768F429CC0476E266DB77EA2B30922775F7371736E229AC0910E34627F3A4E7ED40F6E337560702B2BCA1177ABF3B2568A8C33049D0C094EB7045C45CDC265A3B4518B7F4CBFB87151CE49D7E39EFDF4C170A3BB5C664372A5649DC2355C6F8C66CDF34A0ACA48EDFB45D057FEA151F2A70C0357D57E58C852BB6D165DE54DDB424C171F5A6949CB4D2D9202EA2B439512E607A19CB7E93B0218FAA84C65FB691ECB5EC68AB4A3F34D37C275793A36EFB3E2DA1D6952C7E0841D69757406F0538E34DAA428A3005E9E1CD516AE797C5884D3198634A3DF1F5B6707ADA35D7AE3CC10DE67AD134170FFA97E04FA976A1632DE29FC57F20A9AF0796464B5F66C59865519BB5BD12EF0D6BD8471C017ECCBDA39BE72E11E3459D79BA97B4F00BEF7F4B802F6739BCAB2C9705636DB371D9D684552B4CE64E112101FC6D2FF283CE80DE11573E49FB0CA3572E9D4641CF8618953E324DD498C0C84F77545422325F56FB60F5C62F7DEB7F95B3FA4A02C4F4DC5F2DF45E4FA121A68C6D2C994868B6FD8CD7E978A6CA53D9B2636F407B6EB6CC32867BA03518BB56188901743D18572E3AF2A1B8DC5561ED3B4E7308D9CBEF4747D94C45F5E19C1B3740AB31926012E6B504818CCFA901A9344EF8199F743105DB778170B3FB8DA4DA4642300E0C1C8ED65D5121AC600B09F99E0B2F973A7C7580C5305DF923969C2607F8FD887C174FF61636EDF9A0AA6431017A5181C70F831FFB5CEDFA59C9B4374F371664882047E7FABA41C00643C3A2250E2EF59A9F947E15BA8E570CA0673811B14EF1B5D5D2FC4321C42E1A5F294E099A17B11E8C6A5969A8E7445BE3365097BCB6E07F1558D0703571091AE9C7CB313C583D433A413AA1FD3627F19CEBDFDA18DBFEF3BAC439E356AF79F09D0998EB2F48D4808B9DDFE29A15D18D11A08FA80673BA933087B3899240E41CEAF69B8002483525B4BCDFAFC15AFDEB38A79A51E1C4A55D395776DB5E6F7CCA615C0E1D294BDE77BBEBCEEC1E901D823F05B75A6EDC3EABE5F398705D8985ED97DCB9F4940A31A3A1A88A2A25CDA03E5735741B1B5A2ABA7E98974A70E85BFCA5DE9E3C9141E8ED5F3DE59CB6DE42748EFC2976713A2A4C5E7F02D4C668431068C1A300365FE125CF9EF46DA91E8DDEC476F2B5A1F74951169B794EA58402B2251830CED810C13EC6640CE40DECE0ACCC842F38F453A9EBEB266C6202133215ECAB545957322600CF2CEE659F24136743DF5CCDB18B5A0C648843A17F5A8CA59AF26853EF1E87684B2124A06DCFA9FB15B0D8D5E5FA0B6C3CE4A75EAB15CA70AA364165BD53845ABCF4CE63E6BA73E628D9949974C116BE3D77858C5B30A44E2C132B4B0F7709BB731223ABFC76CB3ED33614DF1934C0DF1DAFE36C8006A521FE82E47B2316C72E15AF548447EB82AB1E5452A83977F78C211D13935EF091000989B8B4E15A008436D9DB227F7AD92A4C0B4C18C2F9E8076FC04B436BE85CA98EBC3F965863B119FD27AE0B8AB91FDCDA60EB502C7E9B8029A23438C24913BB7558F1091525C0BE7F9537F02837A3B346AAFB5F9AF1ED51B1F1BB9B5340E373707D5FB1AD1B54347653944FD2F51BAD7EC1F06EC0074C0CFBEE0FE4DAF5F34132D6B5BC06265B14AB6419CCC5353606E96528C1E6FC959090A159821399118E28A31A1B0C79266B139AAD73352F6356F682BE2D14407F1D58204F2C933066A3163462CB0F65C197961DB54FEBF561A135335635E76486BC69D8DFB9064476A60CA6F2FAA823386501D3D1634DEAC5198B7F1B1A96C0E7A8365CA2432D0F4D3232F1893CCE65FBB7F833144346A830474176268D263B1E799C495727A66EBEB1C216CCF48845C04A314A73786145885FE68F54516E9E489A21DD3E465C7D9ABD0C27768871157ABA67C946FC4DCB07A7C381EDAE0E3724BD5EF87DE004224D39FBC7639CB31F6110496CE21E49CBF13A8F2F785D7889F70C5B0C0F275A513433EFB1F6355E0216E673F6CD8770961EF6BD6B0CEEF4348934DEE91992DAE7E24718FEA4B12A03D8C1F41C970B628A724AC3C761C5C81E29871F5917A15FD871E8D8F80E513902B55A0ABC527633EFA614E81B6C73A32B306C4E7ED62F805C15649DEF0ED48052B481C8FCA07F719F8542D88C3A783B42E72F5518981B28A22E8C791F74E5B367E76EECCAC881BAC2D894BCD13D8736A7CE19C9F8D5E2DF1CA27D3897FDCF720AC998A1053D733E178AA04662D8BF912FB2823DE83F693312028021E8A166E21275B71F558DF05766476ABECB7E170C901AE55E4E5FFDCA1EC05FEA0931ADFE11DCC4E877D2301BBC2D15F9285196E57DF064B578B2AF9B2E86574A2FEA8617493DC6C611FE2F5B990E94DBAC1CAE806D2739A3D71CE50C403D7C0DFDC985E9255520765DA554CD85DB210F8E65180468EDB5B56C684C442FF109AB43F5DF05285B09DEB11FD816BDC80CAD57D7FF48332386A3881A9E6BB44C7FFCE185ECFF7B2577063EE2212D0956B6FDA51D6976991FBA11FB799A5DB9CF8BDB265DF0214C7EB8B694DA92A23803D0512D014DED3CF1677C0B6FE50E4FB23C1A4C443ADA46785EC634739ACCC99EAE3A82B6664F180A0580DDC1A5E16B9CA2E3785C8DE529423DA5FA15EB9B4ACFA92D69C50C66C8CCDF8281C2CBB14FA12E5DCDA205340BD6E1A60AA5A66F81FC8FE1F82F26B3559BB2A1E21413ABB250368678A89F26039CB45F70BDC05CF858D1A6A3DDB28A6805D54BE69C32B3900D19728E3708F26B4682E624916C6561B7AB7BE344D9571BE598B995021CE9FFFC26289D909B846434AB89BEF08BEF0F28C06D5CB478864E1FF8739C9BD0ADFC6D63F0230C17480B65802DFC1AE20BA0A92DD2AE502169F2B6BE9705988C5E0A700C54F907CC92009CF88CE3814C078F4AFB86A59BBE8701AA25541C38CBAC02A12BBC59C679F43631D0B3BB23D9283B798812D02E1FDE0B7FA0CB4D8500ABBC49DDE52AAECA140312054A0A4D5EA8383CC6E56A3A94F279D5798D2B9473820F9C011F0F0CA17755FD015D84C5572FC6DE5A0858FBEFDE9F3198D4814A388618291293A73B89827D4777DD187562AF2515251DDB18999160635784AC5C995718F27E0A2FC6280970EB8D7977946197972EC124546DE030534CA30EE4E5862F9D26F4BEE48D6EBE3CE28E2E9B92710C5BF8435CF5AEAFF57EFCF5ECCE9239D321CCE881773F79471EA4EBBC624EDE1FE024C8994EA98F9668AADE5857C5AAC5949B97539CFF70C96674A997652EB4873CB2844CD14759CC1B4D919BB51C94ED1E9D45BF78D2E13614A40500A65078D52F2CB6D54BC26B9386F451BBEC75CFFE58DB5714D13FD1EF0657748DF92F3E6616A135A998C4DB6E7A71B8EB28729B872B03CB5BA40CC1912B2260D67521883B1F44B6EB507B70DCC73F952D636B11156C047F08300D45A5539691BBACA59EEA7259C84B00A1F9F6DD83FB1A3C5CE5B46BA532A546E0B74E00752FC2A25B565B7107149ABF84B514208D6B9AFFDDC5185C960A2B9D3F6C9456A0BF943AC164FE20118809063C747944163F634AA693F7C8BA14D342215F3B6B4745D98D8AC56DA6792E1A1025453D263529259BDCA9B4CC2E3131BDC9F56338A1558067B6D8D943AD25D76005DD1E40A667AE9CF2830B1E2C08DE207E214247C414BB22472833006161920D1744DFE394ED2B78E6F61A8DF65E0A285CA36B1A1DAAB8CC472F1078304609F40B4F08B9A018EA3D6ADEBF38B546DA4A1C5ABD4E3226278E9BDE3444E3ECE60F358D2759AD0A5F3E6E7D74F818B4F99706D73D4410533A2D8A2F4F9EE5C649F6AE254F2F8A5D918E3F65F2AE52934E2CDD775E7D60213C01C2FA7B015C424F60DA6D02F0C63D525E0956CF17AB6488459117FB59FFA6F0DF9A696EC2E4B885E8F88F09741A9684DB6CC20078649AE24DFDF11B5E93E0EE4A09D233671B7B0E14076C156CE9709F23E891AE69B5EEE173BFB7D825420991E053A05CEA4A88C98A294038CE4772122F3D4D83F80D0276E4FE122720F22BB28AB800E00B7CDDA94961809C69A81F16571EC0E6DA50C9E178F76AB7478E0CF0DC26CF878A690E247D32449DAFB0D3E3265B9491FA4D8AB222F3AD3C60A115F33A71784E044B8CFA77631DE89963F46B5D2149F00BE3E5E805AB91DD62726F48BD10E05E67B60412A3A79082DD3A5CB4F23ADC59C24B3D137EC689CF459B64127D125271B63FE0E266D4AE92820F4804D1C04E203333E50893C879425AE32888FE44FE493DDDDC4FDB496824067C32079FC227D7EA432D47511D5E2A1B50577B5A8906B1DF43E3ED912FF74808E9D83F29950AE5FEE18EE5FD22AD4C1D0F261984282562AC07436DE7A38B1E8E1D0451024467187FD454B66B019AB661B274FE146144082FDEAC6F79F5F4E99C355B599B0A53044AA39C233F405D522E00B89DAED86B2472F1AE2DB422379454F8623F70CB07C1899128FF7D94D20A418ABDCC06615A16729B014A6A201B0F95B1BFED58E2A059BFA7ECBE165F96200888FDB5ED8D3BCBD69B4C23CFFB06B72E81159B69272861CB4274F10B4D9256348F9878A966E88CCF56DDDADE1201E1832A7D84941C6AB996F4CAA354266E2E64194AEE77D78A5D6AD870F57D9B729FBC496D0C17C3675C476435232A54A0D726DB71B4EEDCACE6F21EADF540D5A308053DC79A02F918AD9CFCE97FF1BB2CB438168ABF162DDEB8ED46E2C9DD8E000104C4402DB8F92F892CA9FC05831C94D263892E8DF44377C83DEEE72271206B73470579E413D1F47A2B39DBB3A3EC0DA1424A3581610816688CAE9A6392ED00BB3658BC8B933CDEF94C1B5A86D90D2EA64FE3A911FD9CBC3C6BE1637DA7F3BFA4C730B6F78196525A8F766A7475CC8BDD6A976B71A957118CCCC2C7417ABC852363D90BCEBE7047869223235F3DB29EC21A80A1766A8AF99D04140304CC2AE158190D79BD203B22C74591A06CC583B1650720BA5EA7557869225F3594833E2B03337CA6D01E76DD0889DEF99FCA246E6C104965F18C466ECAA5FF765AA986E4DCCC237B62BA973B3804F4DAFC696B6D32210D72C6034684365E2143836152FB3D8023B63EDB8AF6831D1A745C09C087386AD319EFC3BE277AEF38917345951B1B053CB182A7C725544D35D863C1D9398A720B647BF6A26170858F9F497AA72CEF0B30A773E86F56E96E096B1D2684753B321610C18E867353ED4A9C7CDD162BBC1B83046138C75BB93CEBB8ABF1EF38A83B30161B093BFA310784CD4016464E42ABE1D71007188A2B14285E165E21762B009B0F90FAFD5B38245C01099EDFEBC3D2E9815FAE44E2CFACABCC23E8C6CADB5922B0661FAAED5BE74A0885728159DB1AB6CCCC82C0F05D34BA7784CC52B2AA55DDC73A3A99AB7C7C8D8F052C723D968129675EC5F47856CDCA9877B91677785B4D04CAC57504216B7503F24A500D0F0B2E88E6321A546B56419CA92C7FAEF413FEAC961C87A07408410DEFD9545B0C8195AFD1A2D42B245869C56BFA4AD002269F46DA00095A29835010C4F60EA803346BA72BE7A9503988BF8E6D3E0FEAB23697D7503F994A9B7D654F26003CC2E75BFE854F26DF852F88F02D6667C56FB945A0F80F13F768FF548CA1A876250BA07F715F941748537DB3E6DF85CE4BA0C17838649CAFE30BFAE9B28D828EB22D305E01642347B3797531C588C7D94FEF04617551FB4E282E4F4AD39DDBD801FEB567CA4A0F4986A13697537A94AA596F58292099234E30D58812139290F5A61D223E79EE9E6C00DAB50AD5B4FA318B023E6BDA8763EAADFB64C266A0ACF065FBDEF6CCD69F0BB10B88938A2955228A512716CA5C4F18731F8DBADDB0949211CAC36B58A30464FE455521D4106671F06D9C27641B7EA3F10E9BCCF6D5261710656C8D55D50C982061C7A3C0417ABA1BEB52092947FD73BF5E94A165F3016F371572387B056420D8ED2D5BE9FB65571F249C091AC88E56410743C79E8480FE3BC7AFFBB32F388A9EE8BB786F54D8A24FCF3C41898256240C0BF253204FFDA97DBF727D2B62EC9813F26328215EE9A8E627117CDB45874B1918386091A07E00A1972D0DFB8D9CDF621EEDB063DDEE03A4973775706EB80EEA60D0845ECF77A629AB5A4F4AB180C769721E7639E0D26069E760336FCCDDBE773869B98E548C3A37803E67D39301E5ACD58BD608DB1693E2F7B97F53F57876C8E74869D44C070BB904418A0D63ADE3A7CBC95AA9EE235697CC8833D429226E668FA371406AAED5BA7D399540F86B40148D0D5E2FB6A6E03110D359AD85FBAA4ED8662134993C9AAB662EF4D2B977A3B28F1024D4F19499396FC3461471EC310F3FB5D8122A8558D8A66A9241794F0A6B3223B72DBED4060CBC477D4559D2E708DBCE32D239B98E8155937B10614DCD4D74F535DF01958FBAF4CA6C8D25182686C9CF027D07714B6EEFF79A6A7E5EB09EA4FBE25548AA116CA8223B3F328765B0B0124BEC981385966E1487120CABA3FB00FCE2C1AFB50CF38963340AC1669B1A85B46D2BE6251E2666117136227CD2B5F2972DE319720DDFE28F554881E4906578F0057149DA38E61F73F8C7E1060AAE9AA8979129D4C8C4164826DF2F6FDDBE9935D5AC99986B4A11EE85E7D18DA5B21FB000EF04E49B849BEB7851380BCE447366237D55EE134BEC7E9B8C58D6ED86CB6C3526ACC0F9DE16F925814C3266A2DF8D85A22FB82C95051355BC325DB1DC2EB192833C1764F5B83053BBE1C942BCE41A6D7EF4922927842D3E0683CC1FD08B51DF7C30A52DECF0CA7BD117D08B9FFD504377285565E0155CBA3BFFB7111B53C0FEAC5C9A5B889A5018588032934B8EF1E4432D7892C06BC366CE8AA0C0BA99F5FD0F35C4B7F5BB2249B5A7A741B7393DB400D8D0FB2EA8F4479559A7FDB878CC094A5649567B0F6926CF700E72E719C65FDB1DE0BDC953C40F6A37C627FB6B33701F9A653AF7BF7D77131DE8113B6C00C33D62E836570F84361EAED1F5297DCE93FD80A5B7E8833E4032AF437F5B67E9C8022515F1FB1D5858EE14CA9749F179B811ED5EF558D0B67951E7C6EE8EC46F2EA1A48E919A353819425FEB8F9EF03793F67124A3F130091B5DED46188651A843FD174C27D0180B8E459353EEDAC01961D3A6610D88BD7D4CB46CCD27D32D18BBFA40BD9E15DCACD928E1A1CD487D29CCA1571E22FB1A392B8C1E8E33CFBDD72FB84DA8374446566618CE9A1E60EFFEF0FDF23CA414C8411BEE5DD79EEAB495705B3C942B7890F41A42FD2F207BF5BD9F422D4B79333AEF3B66B315B772D6ED640B7D2F3C3566C6728E4DA772E8317FC548D74163AE19EE13A9E24E9B8F17BC87872AD77044A21AA75080765EB746CA65DA0CD2B9CC508C04C465DEFD52482C4111BA364ACBF1CC569063ACAD24414354AA5D7485935CA37C9C1A0CA4B59028B3978AE242F2E57C6D6FAE061B9E842C41442BDFC0715A895077C25EC62FC7C94B0F409D3C6A8826A6D8327B421AC4FA09045ED666CD7AF4422DBEA320785159658829F71462A0E2685DA9BC1403831CBE2128E6CEF06CC01701E8ED097F64A6E54D74E10810B78413668807221D656FF32AD3E7FB3188236731F4CD2449655033C152C836534C9426205EBBCF856E22BFB2EE1253F2349B63B2BF2E9CD5B454E783D03D6C6AC051A3ED78D94A2C008B2FC82D86DA76159E46CF65738F706CC3F915C8A47B9528A753AB5F56816957C64BC0872D70010324684E056EEBCE968AE1AB0B9359EF49EC59C62BFEACB9643F0319BB0EDC66179625051580A30D56BB48E8F30E0267DEFCA3C945F30A47FA83C72FB0E1FF3B387C269D1E29482484BDB374D80768ECD4031191D04B9157E71E1555B9C8A625112A22B1D81ADFB64DA83FAC5F70E9FAC5F33CCFC13ED075ADD01EC32C5CE6A9000B2FF8EA4940AFBA6F71D5D6889896C3DB0CF97591F975C0D56F10FD8ED227A13D39A345D8446042346BBB36E02C328BE8C0E3E9A263C45DBF2B0C467FFFBA08126CD41761ED4B3DC85FCD2745C5A7781E3AB4002BC985A25F83E790DD40113B686FE68C8DAA3D4C1B5E055DFA5D3249C525B57D35238AD748649D472787D1F545576D64DAB1E06599A1733C527AA28499A8716A37D1E8266C9B63AADEBE9B0D6F60E2DD31C598ECDFCBC5AA40F4D95780E085D8FDEC70CC0670A4E8D33036E1B36C012F6B67F61E0A884A520274E673C51D8CDC01EC0639C765236EC71FE9169F0C56A3C1E4FF77004976F5282F8A95A8FB8931DDF58887C72EB693AB866212B620D7DB79BA1EC1456826D67E313C7E50C5036FF3020D2BEA0AB66AA0CC726A9E634E88B1D6B54A2AC2791B4BC09F66FBB33C6B4D059652EFD2EC27B3084CFE4D6EE10AAE8A26BFC4F9CDE3F539802CD37D4CBF2BD4D266076C7FC27D935B2E3E4D749BE70D60DDDEB20C1B8FB3674AADBAE26C896766F7F80D5FFF5A86605B1750F152081449F98A65520B2E708E0C0800";

        var publicKey = _crypt.GetPublicKeyFromIdentity(identity);
        var signedMessage = Convert.FromHexString(messageHex);
        var message = signedMessage.AsSpan(0, signedMessage.Length - 64).ToArray();
        var signature = signedMessage.AsSpan(signedMessage.Length - 64, 64).ToArray();

        var isValid = _crypt.Verify(publicKey, message, signature);

        Assert.True(isValid);
    }

    [Fact]
    public void ShiftedHex_RoundTrip_PreservesBytes()
    {
        var data = new byte[] { 0x00, 0xFF, 0xAB, 0x42, 0x10 };
        var encoded = _crypt.BytesToShiftedHex(data);

        Assert.Equal(10, encoded.Length);
        Assert.Equal("AAPPKLECBA", encoded);

        var decoded = _crypt.ShiftedHexToBytes(encoded);
        Assert.Equal(data, decoded);
    }

    [Fact]
    public void ShiftedHex_CaseInsensitive()
    {
        var data = new byte[] { 0xAB, 0xCD };
        var encoded = _crypt.BytesToShiftedHex(data);

        var decoded1 = _crypt.ShiftedHexToBytes(encoded);
        var decoded2 = _crypt.ShiftedHexToBytes(encoded.ToLower());

        Assert.Equal(data, decoded1);
        Assert.Equal(data, decoded2);
    }

    [Fact]
    public void SignVerify_WithShiftedHexEncoding_FullRoundTrip()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var message = "test message";
        var messageBytes = System.Text.Encoding.UTF8.GetBytes(message);

        // Sign
        var publicKey = _crypt.GetPublicKey(seed);
        var signature = _crypt.Sign(seed, messageBytes);

        // Encode as shifted hex + K12 checksum (130 chars)
        var checksum = _crypt.KangarooTwelve(signature, 1);
        var encodedSig = _crypt.BytesToShiftedHex(signature) + _crypt.BytesToShiftedHex(checksum);
        Assert.Equal(130, encodedSig.Length);

        var identity = _crypt.GetIdentityFromPublicKey(publicKey);

        // Decode
        var verifyPubKey = _crypt.GetPublicKeyFromIdentity(identity);
        Assert.Equal(publicKey, verifyPubKey);

        var allBytes = _crypt.ShiftedHexToBytes(encodedSig);
        Assert.Equal(65, allBytes.Length);
        var decodedSig = allBytes[..64];
        var checksumByte = allBytes[64];

        var expectedChecksum = _crypt.KangarooTwelve(decodedSig, 1);
        Assert.Equal(expectedChecksum[0], checksumByte);
        Assert.Equal(signature, decodedSig);

        // Verify
        var isValid = _crypt.Verify(verifyPubKey, messageBytes, decodedSig);
        Assert.True(isValid, "Signature verification failed after shifted hex round-trip");
    }

    [Fact]
    public void SignVerify_ViaDirectSchnorrQ_MatchesQubicCrypt()
    {
        var seed = "abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyzabc";
        var message = "test message";
        var messageBytes = System.Text.Encoding.UTF8.GetBytes(message);

        var publicKey = _crypt.GetPublicKey(seed);
        var signature = _crypt.Sign(seed, messageBytes);

        // Verify via reference pattern: pre-hash then SchnorrQ.Verify directly
        var messageDigest = _crypt.KangarooTwelve(messageBytes);
        var isValid = SchnorrQ.Verify(publicKey, messageDigest, signature);
        Assert.True(isValid, "Reference pattern verification failed");
    }

    [Fact]
    public void VerifyRaw_JSGeneratedSignature_IsValid()
    {
        // Test vector from the JS Qubic wallet sign/verify tool
        var identity = "WEWDPTCXKABYFFPDXYHTQCJCBJADFTGTVVMINUBWNEFAGQFDPTUGVGRFKQBK";
        var message = "test";
        var signatureStr = "DFGPHCKJDGIKGGLJGJACOIMOHAJJHMANCNIOILLGPMFFPBDFLGODMKNMFNJJBKODKFJENFLMJICOJDDGPPFBKJLMAGEAMPMIEHIMMIIDNMEBNDBLPEIOALHIELMDCBAAKP";

        var pubKey = _crypt.GetPublicKeyFromIdentity(identity);
        var allBytes = _crypt.ShiftedHexToBytes(signatureStr);
        var signature = allBytes[..64];
        var messageBytes = System.Text.Encoding.UTF8.GetBytes(message);

        // FourQ convention: raw message used directly in challenge K12 input
        var isValid = _crypt.VerifyRaw(pubKey, messageBytes, signature);
        Assert.True(isValid, "JS-generated signature should verify with VerifyRaw");
    }
}
