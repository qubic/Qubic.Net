@typeparam TItem

@code {
    [CascadingParameter] internal DataTable<TItem>? ParentTable { get; set; }

    /// <summary>Column header title.</summary>
    [Parameter] public string Title { get; set; } = "";

    /// <summary>Field accessor for sorting, filtering, and default cell display.</summary>
    [Parameter] public Func<TItem, object?>? Field { get; set; }

    /// <summary>Custom cell template. If null, uses Field(item)?.ToString().</summary>
    [Parameter] public RenderFragment<TItem>? ChildContent { get; set; }

    /// <summary>Whether this column is sortable. Default: true if Field is set.</summary>
    [Parameter] public bool? Sortable { get; set; }

    /// <summary>Whether this column has a filter input. Default: false.</summary>
    [Parameter] public bool Filterable { get; set; }

    /// <summary>CSS class applied to th and td elements.</summary>
    [Parameter] public string? Class { get; set; }

    /// <summary>Column width (CSS value, e.g. "60px", "10%").</summary>
    [Parameter] public string? Width { get; set; }

    /// <summary>Format string for IFormattable values (e.g. "N0").</summary>
    [Parameter] public string? Format { get; set; }

    /// <summary>Whether this is the default sort column.</summary>
    [Parameter] public bool DefaultSort { get; set; }

    /// <summary>If DefaultSort, whether to sort descending initially.</summary>
    [Parameter] public bool DefaultDescending { get; set; }

    /// <summary>Effective sortable: explicit parameter, or true if Field is set.</summary>
    internal bool IsSortable => Sortable ?? (Field != null);

    /// <summary>Current filter text (managed by parent DataTable).</summary>
    internal string FilterValue { get; set; } = "";

    protected override void OnInitialized()
    {
        ParentTable?.AddColumn(this);
    }
}
